package com.utilities.java;

import java.io.FileInputStream;
import java.io.FileOutputStream;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;

public class ExcelRead {

	 static Workbook wb;
	 static FileOutputStream fo;
	
	public   ExcelRead(String inputpath) throws Throwable{
		FileInputStream fi =new FileInputStream(inputpath);
		wb= WorkbookFactory.create(fi);
	}
	public int rowCount(String sheetname){
		
      return wb.getSheet(sheetname).getLastRowNum();
	}
	public static int colCount(String sheetname,int row){
		return wb.getSheet(sheetname).getRow(row).getLastCellNum();
		
		
	}
	public String getCellData(String sheetname,int row,int col){
		String data;
		if(wb.getSheet(sheetname).getRow(row).getCell(col).getCellType()==Cell.CELL_TYPE_NUMERIC){
			 int celldata=(int) wb.getSheet(sheetname).getRow(row).getCell(col).getNumericCellValue();
			 
			 data=String.valueOf(celldata);
		}
		else{
			
			 data=wb.getSheet(sheetname).getRow(row).getCell(col).getStringCellValue();
		}
		return data;
	}
	public static void setCellData(String sheetname,int row,int col ,String status,String outputpath ) throws Throwable{
		
		wb.getSheet(sheetname).getRow(row).createCell(col).setCellValue(status);
		fo = new FileOutputStream(outputpath);
		wb.write(fo);
		wb.close();
		fo.close();
	}
	public String sheetName(int index){
		
		String Sname =wb.getSheetNax);
		return Sname;me(inde
		
	}
	public int noOfSheets(){
		int numberofsheets =wb.getNumberOfSheets();
		return numberofsheets;
		
	}

}
